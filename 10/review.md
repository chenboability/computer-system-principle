# review

## 总结：

这篇文章提出了一个硬件标记内存的架构——Loki，用来对物理内存提供细粒度的、软件管理的访问控制，为不同抽象层通过差异的安全机制，同时对HiStar系统（微内核）进行修改，提出了LoStar系统，阐述了标记内存的方式可以有效降低系统TCB量，提高安全性。 

LoStar基于安全监控器，实现了两种保护机制，其中信息流控制机制通过内核来保证恶意程序无法将敏感数据泄露到系统之外，随机访问控制机制利用线程label的读写权限对敏感对象的访问进行限制，同时保证线程无法随意修改label权限。提供了一种新的硬件拓展架构：每个线程都运行在对应的内核实例中，内核实例只具有与线程相匹配的权限（受限的权限），而其他所有共享状态是由底层的安全监控器管理的。此外，安全监控器还维护着HiStar label和Loki tag的映射关系，并且对线程的Loki permission cache进行追踪。通过这种隔离机制，将大的操作系统内核切分成小（受限）内核，从而保障了一种“前向安全”，即使一个进程及其对应的内核被攻击者控制了，也无法通过修改label权限来控制其他进程的内核。

对于一些不应该被不可信内核代码任意修改的敏感数据，安全监控器将其访问权限设置为只读，同时提供了一种类似系统调用的接口来对数据进行修改。监控器对于上下文切换、内存和保护域的操作等都实现了一系列调用接口。LoStar需要处理两种类型的中断，第一种是传统的cpu异常，若是同步异常则交给运行的内核实例处理，若是异步异常则可交给运行的内核实例或设备驱动保护域；第二种是Loki的tag异常，处理器将进入监控模式，且需要事先配置tag异常处理器。

Loki：为了降低内存的开销和对系统性能的影响，内存标记方法采用了多粒度的标签存储方式。利用一个32位的tag来标记一个32位的内存字，存储在一个线性数组page-tag array中，并且利用率类似TLB的缓存策略来加快索引。权限检查是由硬件提供的P-cache机制来实现的，存储了tag值和3个bit，分别表示读、写、执行权限。监控器对于P-cache缺失的处理方式和一般的软件管理TLB是一致的，只是将其进行补全。Tag异常处理机制是独立于传统的cpu异常处理机制，当发生tag异常时，Loki保存异常信息到寄存器，关MMU和外部设备中断，然后进入监控特权级，跳转到监控器的异常处理器中处理tag异常。

性能评估：基于SPARC架构实现了Loki原型系统，在可信计算基评估上，LoStar相对于原始的HiStar，TCB的量降低了超过一半；性能方面，大部分基准测试LoStar取得和原始HiStar相似的性能，表明了修改后的LoStar所造成的性能下降是在可接受范围内。

## 观点：

（1）优点：

1. 设计了一个硬件标记内存的架构Loki，用来对物理内存提供细粒度的、软件管理的访问控制；
2. 对HiStar系统进行修改，提出了LoStar系统，阐述了标记内存的方式可以有效降低系统中可信代码的总量；
3. 对LoStar系统进行评估，结果表明TCB的量降低了超过一半且导致的性能下降是在可接受范围内。

（2）缺点：

1. 存储tag需要额外的内存空间，降低了空间利用率。
通过评估其性能，发现尽管减少了可信代码的数量，但是没有正式的系统安全性证
开发多了限制，虽然可能只能在特定方面有很大的应用
